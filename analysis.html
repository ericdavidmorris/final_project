<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">The [Bi]Cycles of Life</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">home</a>
</li>
<li>
  <a href="about.html">about</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="analysis.html">analysis + findings</a>
    </li>
    <li>
      <a href="visualizations.html">visualizations</a>
    </li>
    <li>
      <a href="screencast.html">screencast</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    contact
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:edm2152@cumc.columbia.edu">
        <span class="fa fa-envelope"></span>
         
        eric morris
      </a>
    </li>
    <li>
      <a href="mailto:gsl2116@cumc.columbia.edu">
        <span class="fa fa-envelope"></span>
         
        grace liu
      </a>
    </li>
    <li>
      <a href="mailto:tm2680@cumc.columbia.edu">
        <span class="fa fa-envelope"></span>
         
        tatini mal-sarkar
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.youtube.com/watch?v=FAFfefzMlJo&amp;feature=youtu.be">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="report.html">
    <span class="fa fa-book fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ericdavidmorris/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://citibikenyc.com">
    <span class="fa fa-bicycle fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Analysis</h1>

</div>


<div id="exploratory-analysis" class="section level2">
<h2>Exploratory Analysis</h2>
<p>We restricted our analyses to users who pay for subscriptions and to trips lasting longer than 5 minutes and shorter than or equal to 45 minutes. We also eliminated all stations we thought weren’t really stations, like kiosks, depots, and valets. Then, we did some overall exploratory analysis on demographic variables, like gender and age. Finally, we investigated which stations were the most popular to start and end at.</p>
<div id="demographics" class="section level3">
<h3>Demographics</h3>
<pre class="r"><code>citibike_tidy %&gt;% 
  mutate(gender = ifelse(gender == 0, &quot;Male&quot;, &quot;Female&quot;)) %&gt;% 
  group_by(gender) %&gt;% 
  summarize(number = n(),
            mean_age = mean(rider_age),
            median_age = median(rider_age),
            sd_age = sd(rider_age)) %&gt;% 
  rename(&quot;Gender&quot; = gender,
         &quot;Number&quot; = number,
         &quot;Mean Age&quot; = mean_age,
         &quot;Median Age&quot; = median_age,
         &quot;Standard Deviation&quot; = sd_age) %&gt;% 
  knitr::kable(align = &quot;c&quot;, digits = 2) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Gender
</th>
<th style="text-align:center;">
Number
</th>
<th style="text-align:center;">
Mean Age
</th>
<th style="text-align:center;">
Median Age
</th>
<th style="text-align:center;">
Standard Deviation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Female
</td>
<td style="text-align:center;">
250221
</td>
<td style="text-align:center;">
39.01
</td>
<td style="text-align:center;">
36
</td>
<td style="text-align:center;">
11.97
</td>
</tr>
<tr>
<td style="text-align:center;">
Male
</td>
<td style="text-align:center;">
824539
</td>
<td style="text-align:center;">
40.12
</td>
<td style="text-align:center;">
38
</td>
<td style="text-align:center;">
11.91
</td>
</tr>
</tbody>
</table>
</div>
<div id="most-and-least-used-starting-stations" class="section level3">
<h3>Most (and least) used starting stations</h3>
<pre class="r"><code># Top 5 starting stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(5, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  mutate(n = format(n, big.mark = &quot;,&quot;)) %&gt;%
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Times used in January 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Starting CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in January 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Pershing Square North
</td>
<td style="text-align:center;">
7,683
</td>
</tr>
<tr>
<td style="text-align:center;">
W 21 St &amp; 6 Ave
</td>
<td style="text-align:center;">
4,029
</td>
</tr>
<tr>
<td style="text-align:center;">
8 Ave &amp; W 33 St
</td>
<td style="text-align:center;">
4,028
</td>
</tr>
<tr>
<td style="text-align:center;">
E 17 St &amp; Broadway
</td>
<td style="text-align:center;">
3,880
</td>
</tr>
<tr>
<td style="text-align:center;">
Broadway &amp; E 22 St
</td>
<td style="text-align:center;">
3,813
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Top 5 starting stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(5, n) %&gt;% 
  arrange(desc(n)) %&gt;%
  mutate(n = format(n, big.mark = &quot;,&quot;)) %&gt;%
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Times used in March 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Starting CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in March 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Pershing Square North
</td>
<td style="text-align:center;">
8,081
</td>
</tr>
<tr>
<td style="text-align:center;">
W 33 St &amp; 7 Ave
</td>
<td style="text-align:center;">
4,553
</td>
</tr>
<tr>
<td style="text-align:center;">
E 17 St &amp; Broadway
</td>
<td style="text-align:center;">
4,212
</td>
</tr>
<tr>
<td style="text-align:center;">
Broadway &amp; E 22 St
</td>
<td style="text-align:center;">
4,102
</td>
</tr>
<tr>
<td style="text-align:center;">
W 21 St &amp; 6 Ave
</td>
<td style="text-align:center;">
3,983
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 5 starting stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-5, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Times used in January 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Starting CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in January 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Henry St &amp; Bay St
</td>
<td style="text-align:center;">
18
</td>
</tr>
<tr>
<td style="text-align:center;">
Columbia St &amp; W 9 St
</td>
<td style="text-align:center;">
25
</td>
</tr>
<tr>
<td style="text-align:center;">
Sigourney St &amp; Columbia St
</td>
<td style="text-align:center;">
33
</td>
</tr>
<tr>
<td style="text-align:center;">
Clinton St &amp; Centre St
</td>
<td style="text-align:center;">
36
</td>
</tr>
<tr>
<td style="text-align:center;">
Columbia St &amp; Lorraine St
</td>
<td style="text-align:center;">
37
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 5 starting stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-5, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Times used in March 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Starting CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in March 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
3 Ave &amp; Schermerhorn St
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
Jackson St &amp; Leonard St
</td>
<td style="text-align:center;">
14
</td>
</tr>
<tr>
<td style="text-align:center;">
Columbia St &amp; W 9 St
</td>
<td style="text-align:center;">
15
</td>
</tr>
<tr>
<td style="text-align:center;">
Columbia St &amp; Lorraine St
</td>
<td style="text-align:center;">
20
</td>
</tr>
<tr>
<td style="text-align:center;">
10 Hudson Yards
</td>
<td style="text-align:center;">
21
</td>
</tr>
</tbody>
</table>
</div>
<div id="most-and-least-used-terminal-stations" class="section level3">
<h3>Most (and least) used terminal stations</h3>
<pre class="r"><code># Top 5 terminal stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(5, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  mutate(n = format(n, big.mark = &quot;,&quot;)) %&gt;%
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Times used in January 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Terminal CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in January 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Pershing Square North
</td>
<td style="text-align:center;">
7,744
</td>
</tr>
<tr>
<td style="text-align:center;">
Broadway &amp; E 22 St
</td>
<td style="text-align:center;">
4,722
</td>
</tr>
<tr>
<td style="text-align:center;">
E 17 St &amp; Broadway
</td>
<td style="text-align:center;">
4,272
</td>
</tr>
<tr>
<td style="text-align:center;">
W 21 St &amp; 6 Ave
</td>
<td style="text-align:center;">
4,146
</td>
</tr>
<tr>
<td style="text-align:center;">
8 Ave &amp; W 33 St
</td>
<td style="text-align:center;">
4,143
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Top 5 terminal stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(5, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  mutate(n = format(n, big.mark = &quot;,&quot;)) %&gt;%
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Times used in March 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Terminal CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in March 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Pershing Square North
</td>
<td style="text-align:center;">
7,971
</td>
</tr>
<tr>
<td style="text-align:center;">
W 33 St &amp; 7 Ave
</td>
<td style="text-align:center;">
5,482
</td>
</tr>
<tr>
<td style="text-align:center;">
Broadway &amp; E 22 St
</td>
<td style="text-align:center;">
4,504
</td>
</tr>
<tr>
<td style="text-align:center;">
E 17 St &amp; Broadway
</td>
<td style="text-align:center;">
4,455
</td>
</tr>
<tr>
<td style="text-align:center;">
W 21 St &amp; 6 Ave
</td>
<td style="text-align:center;">
4,042
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 5 terminal stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-5, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Times used in January 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Terminal CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in January 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Exchange Place
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
E 71 St &amp; 1 Ave
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
Henry St &amp; Bay St
</td>
<td style="text-align:center;">
21
</td>
</tr>
<tr>
<td style="text-align:center;">
Columbia St &amp; W 9 St
</td>
<td style="text-align:center;">
21
</td>
</tr>
<tr>
<td style="text-align:center;">
Henry St &amp; W 9 St
</td>
<td style="text-align:center;">
27
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 5 terminal stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-5, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Times used in March 2017 (n)&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Terminal CitiBike Station (Address)
</th>
<th style="text-align:center;">
Times used in March 2017 (n)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Essex Light Rail
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
3 Ave &amp; Schermerhorn St
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
Morris Canal
</td>
<td style="text-align:center;">
5
</td>
</tr>
<tr>
<td style="text-align:center;">
Jackson St &amp; Leonard St
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
10 Hudson Yards
</td>
<td style="text-align:center;">
18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="linear-regression" class="section level2">
<h2>Linear regression</h2>
<p>We were pretty excited to see which stations were most used in January and March. Then we got to thinking about what sort of stuff might affect trip length, like age, sex, and time of day. Time of day had us confused for a while, because we weren’t convinced there was a directly linear relationship between each added hour and trip length (7 to 8am is pretty different from 1 to 2am, for instance). So we treated time of day as a categorical variable, with morning as 6am-12pm, afternoon as 12pm-6pm, and night as 5pm-12am, and the reference group as 12am-6am.</p>
<pre class="r"><code># exploring a model for predicting trip duration
fit = lm(trip_duration ~ rider_age + gender + morning + afternoon + night, 
   data = citibike_tidy) 

fit %&gt;% 
  broom::tidy() %&gt;% 
  rename(&quot;Predictor&quot; = term,
         &quot;Estimate&quot; = estimate,
         &quot;Standard Error&quot; = std.error,
         &quot;Test Statistic&quot; = statistic,
         &quot;p-value&quot; = p.value) %&gt;% 
  knitr::kable(align = &quot;c&quot;, digits = 2) %&gt;% 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;), full_width = F, position = &quot;center&quot;)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Predictor
</th>
<th style="text-align:center;">
Estimate
</th>
<th style="text-align:center;">
Standard Error
</th>
<th style="text-align:center;">
Test Statistic
</th>
<th style="text-align:center;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:center;">
638.33
</td>
<td style="text-align:center;">
3.17
</td>
<td style="text-align:center;">
201.05
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
rider_age
</td>
<td style="text-align:center;">
1.67
</td>
<td style="text-align:center;">
0.04
</td>
<td style="text-align:center;">
46.39
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
gender1
</td>
<td style="text-align:center;">
53.79
</td>
<td style="text-align:center;">
1.01
</td>
<td style="text-align:center;">
53.23
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
morning
</td>
<td style="text-align:center;">
37.16
</td>
<td style="text-align:center;">
2.94
</td>
<td style="text-align:center;">
12.64
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
afternoon
</td>
<td style="text-align:center;">
56.14
</td>
<td style="text-align:center;">
2.93
</td>
<td style="text-align:center;">
19.15
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
night
</td>
<td style="text-align:center;">
50.55
</td>
<td style="text-align:center;">
2.97
</td>
<td style="text-align:center;">
17.03
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Plotting residuals 

citibike_tidy %&gt;% 
  modelr::add_residuals(fit) %&gt;% 
  ggplot(aes(x = gender, y = resid)) +
  geom_violin()</code></pre>
<p><img src="analysis_files/figure-html/linear_mod_res-1.png" width="672" /></p>
<pre class="r"><code>citibike_tidy %&gt;% 
  modelr::add_residuals(fit) %&gt;% 
  gather(key = time, value = drop_var, overnight:night) %&gt;% 
  select(-drop_var) %&gt;% 
  ggplot(aes(x = time, y = resid)) +
  geom_violin()</code></pre>
<p><img src="analysis_files/figure-html/linear_mod_res-2.png" width="672" /></p>
<p>We attempted to cross-validate our model and compare to a simpler linear model which didn’t include time of day.</p>
<pre class="r"><code>cv_citibike = 
  crossv_mc(citibike_tidy, 50)

cv_citibike = 
  cv_citibike %&gt;% 
  mutate(our_model = map(train, ~lm(trip_duration ~ rider_age + gender + morning + afternoon + night, data = .)),
         simple_model = map(train, ~lm(trip_duration ~ rider_age + gender, data = .x))) %&gt;% 
  mutate(rmse_our = map2_dbl(our_model, test, ~rmse(model = .x, data = .y)),
         rmse_simple = map2_dbl(simple_model, test, ~rmse(model = .x, data = .y)))

cv_citibike %&gt;% 
  select(starts_with(&quot;rmse&quot;)) %&gt;% 
  gather(key = model, value = rmse) %&gt;% 
  mutate(model = str_replace(model, &quot;rmse_&quot;, &quot;&quot;),
         model = fct_inorder(model)) %&gt;% 
  ggplot(aes(x = model, y = rmse)) +
  geom_violin() +
  theme_bw() +
  labs(title = &quot;Violin plots of two linear models&#39; RMSE&quot;,
       x = &quot;Model&quot;,
       y = &quot;RMSE&quot;)</code></pre>
<p><img src="analysis_files/figure-html/Cross%20Validation%20and%20RMSE%20visualization-1.png" width="672" /></p>
</div>

&nbsp;
<hr />

<p style="text-align: center; font-size: 75%">A work by <a href="https://github.com/ericdavidmorris/">Eric Morris</a>, <a href="https://github.com/gswliu/">Grace Liu</a>, & <a href="https://github.com/tatinimalsarkar/">Tatini Mal-Sarkar</a></p>
<p style="text-align: center; font-size: 75%"><span style="color: #808080;">Data obtained from <a href="https://www.citibikenyc.com/system-data">CitiBike NYC</a></span></p>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
