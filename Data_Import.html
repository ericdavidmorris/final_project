<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Data Import and Exploration</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">The [Bi]Cycles of Life</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">home</a>
</li>
<li>
  <a href="about.html">about</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data.html">about the data</a>
    </li>
    <li>
      <a href="analysis.html">analysis + findings</a>
    </li>
    <li>
      <a href="visualizations.html">visualizations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    contact
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:edm2152@cumc.columbia.edu">
        <span class="fa fa-envelope"></span>
         
        Eric Morris
      </a>
    </li>
    <li>
      <a href="mailto:gsl2116@cumc.columbia.edu">
        <span class="fa fa-envelope"></span>
         
        Grace Liu
      </a>
    </li>
    <li>
      <a href="mailto:tm2680@cumc.columbia.edu">
        <span class="fa fa-envelope"></span>
         
        Tatini Mal-Sakar
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.youtube.com">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ericdavidmorris/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://citibikenyc.com">
    <span class="fa fa-bicycle fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data Import and Exploration</h1>

</div>


<div id="introduction" class="section level3">
<h3>Introduction</h3>
</div>
<div id="data-import" class="section level2">
<h2><em>Data Import</em></h2>
<p>CSV zip files (corresponding to each month) of Citi Bike data for 2017 were downloaded from <a href="https://s3.amazonaws.com/tripdata/index.html">the company’s system data website</a>, which is provided according to the <a href="https://www.citibikenyc.com/data-sharing-policy">NYCBS Data Use Policy</a>. Originally, we felt it was better to download directly from the data source for reproducibility purposes, however, when using read_csv with the direct URL to the zip, there were several parsing errors and the import failed. This may be due to the size of the files (zips vary from 25-70 MB). We decided to download the zips of two months of interest and add them to our project’s data folder and import from there.</p>
<pre class="r"><code># Removed col names type for now and went with automatic column parsing which seemed to work  well

# Need to add a variable/split date so we can identify if the trip is in the January or March dataset 

citibike_import = function(file) {
  
  df = read_csv(file, col_names = TRUE) %&gt;%
    janitor::clean_names() %&gt;% 
    separate(start_time, into = c(&quot;start_date&quot;, &quot;start_time&quot;), sep = &quot; &quot;) %&gt;% 
    separate(stop_time, into = c(&quot;stop_date&quot;, &quot;stop_time&quot;), sep = &quot; &quot;) %&gt;% 
    separate(start_date, into = c(&quot;start_year&quot;, &quot;start_month&quot;, &quot;start_day&quot;), sep = &quot;-&quot;) %&gt;% 
    separate(stop_date, into = c(&quot;stop_year&quot;, &quot;stop_month&quot;, &quot;stop_day&quot;), sep = &quot;-&quot;) %&gt;% 
    mutate(user_type = tolower(user_type),
           gender = as.factor(gender),
           start_month = ifelse(start_month == &quot;01&quot;, &quot;January&quot;, &quot;March&quot;),
           stop_month = ifelse(start_month == &quot;01&quot;, &quot;January&quot;, &quot;March&quot;),
           trip_minutes = (trip_duration / 60),
           rider_age = (2017 - birth_year)) %&gt;% 
    filter(user_type == &quot;subscriber&quot;,
           trip_minutes &gt; 5,
           trip_minutes &lt;= 45)
    
  df
  
}

citibike_tidy = 
  bind_rows(citibike_import(&quot;./data/201701-citibike-tripdata.csv.zip&quot;),
            citibike_import(&quot;./data/201703-citibike-tripdata.csv.zip&quot;))</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   `Trip Duration` = col_integer(),
##   `Start Time` = col_datetime(format = &quot;&quot;),
##   `Stop Time` = col_datetime(format = &quot;&quot;),
##   `Start Station ID` = col_integer(),
##   `Start Station Name` = col_character(),
##   `Start Station Latitude` = col_double(),
##   `Start Station Longitude` = col_double(),
##   `End Station ID` = col_integer(),
##   `End Station Name` = col_character(),
##   `End Station Latitude` = col_double(),
##   `End Station Longitude` = col_double(),
##   `Bike ID` = col_integer(),
##   `User Type` = col_character(),
##   `Birth Year` = col_integer(),
##   Gender = col_integer()
## )
## Parsed with column specification:
## cols(
##   `Trip Duration` = col_integer(),
##   `Start Time` = col_datetime(format = &quot;&quot;),
##   `Stop Time` = col_datetime(format = &quot;&quot;),
##   `Start Station ID` = col_integer(),
##   `Start Station Name` = col_character(),
##   `Start Station Latitude` = col_double(),
##   `Start Station Longitude` = col_double(),
##   `End Station ID` = col_integer(),
##   `End Station Name` = col_character(),
##   `End Station Latitude` = col_double(),
##   `End Station Longitude` = col_double(),
##   `Bike ID` = col_integer(),
##   `User Type` = col_character(),
##   `Birth Year` = col_integer(),
##   Gender = col_integer()
## )</code></pre>
<pre class="r"><code># Reading the data directly from website doesn&#39;t work - thousands of parsing failures, both with auto parsing and when specifing column parsing in function
# citibike_import(&quot;https://s3.amazonaws.com/tripdata/201701-citibike-tripdata.csv.zip&quot;),
# citibike_import(&quot;https://s3.amazonaws.com/tripdata/201703-citibike-tripdata.csv.zip&quot;))</code></pre>
</div>
<div id="research-questions-of-interest" class="section level2">
<h2>Research Questions of Interest:</h2>
<ul>
<li>Most popular/used beginning station (and least)</li>
</ul>
<pre class="r"><code># Top 10 starting stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(10, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Starting CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Pershing Square North</td>
<td align="center">7784</td>
</tr>
<tr class="even">
<td align="center">8 Ave &amp; W 33 St</td>
<td align="center">4080</td>
</tr>
<tr class="odd">
<td align="center">W 21 St &amp; 6 Ave</td>
<td align="center">4059</td>
</tr>
<tr class="even">
<td align="center">E 17 St &amp; Broadway</td>
<td align="center">3949</td>
</tr>
<tr class="odd">
<td align="center">Broadway &amp; E 22 St</td>
<td align="center">3841</td>
</tr>
<tr class="even">
<td align="center">W 41 St &amp; 8 Ave</td>
<td align="center">3802</td>
</tr>
<tr class="odd">
<td align="center">W 31 St &amp; 7 Ave</td>
<td align="center">3540</td>
</tr>
<tr class="even">
<td align="center">W 38 St &amp; 8 Ave</td>
<td align="center">3482</td>
</tr>
<tr class="odd">
<td align="center">W 20 St &amp; 11 Ave</td>
<td align="center">3351</td>
</tr>
<tr class="even">
<td align="center">8 Ave &amp; W 31 St</td>
<td align="center">3326</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Top 10 starting stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(10, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Starting CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Pershing Square North</td>
<td align="center">8138</td>
</tr>
<tr class="even">
<td align="center">W 33 St &amp; 7 Ave</td>
<td align="center">4578</td>
</tr>
<tr class="odd">
<td align="center">E 17 St &amp; Broadway</td>
<td align="center">4255</td>
</tr>
<tr class="even">
<td align="center">Broadway &amp; E 22 St</td>
<td align="center">4141</td>
</tr>
<tr class="odd">
<td align="center">W 21 St &amp; 6 Ave</td>
<td align="center">4009</td>
</tr>
<tr class="even">
<td align="center">8 Ave &amp; W 33 St</td>
<td align="center">3968</td>
</tr>
<tr class="odd">
<td align="center">E 47 St &amp; Park Ave</td>
<td align="center">3842</td>
</tr>
<tr class="even">
<td align="center">W 41 St &amp; 8 Ave</td>
<td align="center">3801</td>
</tr>
<tr class="odd">
<td align="center">W 52 St &amp; 5 Ave</td>
<td align="center">3800</td>
</tr>
<tr class="even">
<td align="center">W 31 St &amp; 7 Ave</td>
<td align="center">3784</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 10 starting stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-10, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Starting CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">NYCBS Depot - FAR</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">Kiosk in a box Motivate</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">Bressler</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">NYCBS Depot BAL - DYR</td>
<td align="center">17</td>
</tr>
<tr class="odd">
<td align="center">Henry St &amp; Bay St</td>
<td align="center">21</td>
</tr>
<tr class="even">
<td align="center">NYCBS Depot - STY</td>
<td align="center">24</td>
</tr>
<tr class="odd">
<td align="center">Columbia St &amp; W 9 St</td>
<td align="center">25</td>
</tr>
<tr class="even">
<td align="center">Sigourney St &amp; Columbia St</td>
<td align="center">34</td>
</tr>
<tr class="odd">
<td align="center">Clinton St &amp; Centre St</td>
<td align="center">36</td>
</tr>
<tr class="even">
<td align="center">Columbia St &amp; Lorraine St</td>
<td align="center">38</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 10 starting stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(start_station_id, start_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-10, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-start_station_id) %&gt;% 
  rename(&quot;Starting CitiBike Station (Address)&quot; = start_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Starting CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">3 Ave &amp; Schermerhorn St</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">Bressler</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">SSP Tech Workshop</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">NYCBS Depot BAL - DYR</td>
<td align="center">12</td>
</tr>
<tr class="odd">
<td align="center">Jackson St &amp; Leonard St</td>
<td align="center">14</td>
</tr>
<tr class="even">
<td align="center">Columbia St &amp; W 9 St</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="center">Columbia St &amp; Lorraine St</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td align="center">10 Hudson Yards</td>
<td align="center">21</td>
</tr>
<tr class="odd">
<td align="center">Dwight St &amp; Van Dyke St</td>
<td align="center">23</td>
</tr>
<tr class="even">
<td align="center">NYCBS Depot - STY</td>
<td align="center">25</td>
</tr>
<tr class="odd">
<td align="center">Henry St &amp; Bay St</td>
<td align="center">25</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Remove NYCBS Depots? </code></pre>
<ul>
<li>Most popular/used ending station (and least)</li>
</ul>
<pre class="r"><code># Top 10 terminal stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(10, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Terminal CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Pershing Square North</td>
<td align="center">7850</td>
</tr>
<tr class="even">
<td align="center">Broadway &amp; E 22 St</td>
<td align="center">4781</td>
</tr>
<tr class="odd">
<td align="center">E 17 St &amp; Broadway</td>
<td align="center">4347</td>
</tr>
<tr class="even">
<td align="center">W 21 St &amp; 6 Ave</td>
<td align="center">4217</td>
</tr>
<tr class="odd">
<td align="center">8 Ave &amp; W 33 St</td>
<td align="center">4168</td>
</tr>
<tr class="even">
<td align="center">W 52 St &amp; 5 Ave</td>
<td align="center">3993</td>
</tr>
<tr class="odd">
<td align="center">W 41 St &amp; 8 Ave</td>
<td align="center">3843</td>
</tr>
<tr class="even">
<td align="center">W 31 St &amp; 7 Ave</td>
<td align="center">3632</td>
</tr>
<tr class="odd">
<td align="center">W 20 St &amp; 11 Ave</td>
<td align="center">3476</td>
</tr>
<tr class="even">
<td align="center">W 38 St &amp; 8 Ave</td>
<td align="center">3468</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Top 10 terminal stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(10, n) %&gt;% 
  arrange(desc(n)) %&gt;% 
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Terminal CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Pershing Square North</td>
<td align="center">8084</td>
</tr>
<tr class="even">
<td align="center">W 33 St &amp; 7 Ave</td>
<td align="center">5521</td>
</tr>
<tr class="odd">
<td align="center">Broadway &amp; E 22 St</td>
<td align="center">4560</td>
</tr>
<tr class="even">
<td align="center">E 17 St &amp; Broadway</td>
<td align="center">4517</td>
</tr>
<tr class="odd">
<td align="center">W 21 St &amp; 6 Ave</td>
<td align="center">4089</td>
</tr>
<tr class="even">
<td align="center">W 52 St &amp; 5 Ave</td>
<td align="center">3956</td>
</tr>
<tr class="odd">
<td align="center">8 Ave &amp; W 33 St</td>
<td align="center">3833</td>
</tr>
<tr class="even">
<td align="center">W 41 St &amp; 8 Ave</td>
<td align="center">3807</td>
</tr>
<tr class="odd">
<td align="center">E 47 St &amp; Park Ave</td>
<td align="center">3784</td>
</tr>
<tr class="even">
<td align="center">W 38 St &amp; 8 Ave</td>
<td align="center">3601</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 10 terminal stations in the month of January

citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-10, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Terminal CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Exchange Place</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">E 71 St &amp; 1 Ave</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">NYCBS Depot BAL - DYR</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">NYCBS Depot - FAR</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">Kiosk in a box Motivate</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center">Bressler</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">Columbia St &amp; W 9 St</td>
<td align="center">21</td>
</tr>
<tr class="even">
<td align="center">Henry St &amp; Bay St</td>
<td align="center">22</td>
</tr>
<tr class="odd">
<td align="center">NYCBS Depot - STY</td>
<td align="center">25</td>
</tr>
<tr class="even">
<td align="center">Henry St &amp; W 9 St</td>
<td align="center">27</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Bottom 10 terminal stations in the month of March

citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(end_station_id, end_station_name) %&gt;% 
  summarize(n = n()) %&gt;% 
  ungroup() %&gt;% 
  top_n(-10, n) %&gt;% 
  arrange(n) %&gt;% 
  select(-end_station_id) %&gt;% 
  rename(&quot;Terminal CitiBike Station (Address)&quot; = end_station_name,
         &quot;Number of times used&quot; = n) %&gt;% 
  knitr::kable(align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Terminal CitiBike Station (Address)</th>
<th align="center">Number of times used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Essex Light Rail</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3 Ave &amp; Schermerhorn St</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">Bressler</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">Morris Canal</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">NYCBS Depot BAL - DYR</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">SSP Tech Workshop</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">Jackson St &amp; Leonard St</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">Penn Station Valet - Valet Scan</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="center">10 Hudson Yards</td>
<td align="center">18</td>
</tr>
<tr class="even">
<td align="center">Columbia St &amp; W 9 St</td>
<td align="center">21</td>
</tr>
</tbody>
</table>
<ul>
<li>Mapping the above (like airbnb from class)</li>
<li>ERIC!!! *</li>
</ul>
<pre class="r"><code># citibike_tidy %&gt;% 
#  filter(start_month == &quot;01&quot;) %&gt;% 
#  group_by(start_station_id, start_station_name, start_station_latitude, start_station_longitude) %&gt;% 
#  summarize(n = n()) %&gt;% 
#  filter(n &gt; 1000) %&gt;% 
#  plot_ly(x = ~start_station_longitude, y = ~start_station_latitude, type = &quot;scatter&quot;, mode = &quot;markers&quot;,
#          alpha = 0.3, 
#          color = ~n)

##ggplot of above

## map of nyc based on lat/long, overlay ggplot on top? https://cran.r-project.org/web/packages/magick/vignettes/intro.html#combining

#Jan
citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(start_station_id, start_station_latitude, start_station_longitude) %&gt;% 
  summarize(n = n()) %&gt;% 
  filter(n &gt; 100) %&gt;% 
  ggplot(aes(x = start_station_longitude, y = start_station_latitude, color = n)) +
  geom_point(alpha = 0.3) + 
  scale_color_viridis() +
  coord_cartesian() +
  theme_classic()</code></pre>
<p><img src="Data_Import_files/figure-html/Plotly-1.png" width="672" /></p>
<pre class="r"><code>#March 
citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(start_station_id, start_station_latitude, start_station_longitude) %&gt;% 
  summarize(n = n()) %&gt;% 
  filter(n &gt; 100) %&gt;% 
  ggplot(aes(x = start_station_longitude, y = start_station_latitude, color = n)) +
  geom_point(alpha = 0.3) + 
  scale_color_viridis() +
  coord_cartesian() +
  theme_classic()</code></pre>
<p><img src="Data_Import_files/figure-html/Plotly-2.png" width="672" /></p>
<pre class="r"><code>## ggplot of end stations

#Jan
citibike_tidy %&gt;% 
  filter(start_month == &quot;January&quot;) %&gt;% 
  group_by(end_station_id, end_station_latitude, end_station_longitude) %&gt;% 
  summarize(n = n()) %&gt;% 
  filter(n &gt; 100) %&gt;% 
  ggplot(aes(x = end_station_longitude, y = end_station_latitude, color = n)) +
  geom_point(alpha = 0.3) + 
  scale_color_viridis() +
  coord_cartesian() +
  theme_classic()</code></pre>
<p><img src="Data_Import_files/figure-html/Plotly-3.png" width="672" /></p>
<pre class="r"><code>#March
citibike_tidy %&gt;% 
  filter(start_month == &quot;March&quot;) %&gt;% 
  group_by(end_station_id, end_station_latitude, end_station_longitude) %&gt;% 
  summarize(n = n()) %&gt;% 
  filter(n &gt; 100) %&gt;% 
  ggplot(aes(x = end_station_longitude, y = end_station_latitude, color = n)) +
  geom_point(alpha = 0.3) + 
  scale_color_viridis() +
  coord_cartesian() +
  theme_classic()</code></pre>
<p><img src="Data_Import_files/figure-html/Plotly-4.png" width="672" /></p>
<pre class="r"><code># least used stations plotly 

#citibike_tidy %&gt;% 
#  filter(start_month == &quot;01&quot;) %&gt;% 
#  group_by(start_station_name, start_station_latitude, start_station_longitude) %&gt;%  
#  summarize(n = n()) %&gt;% 
#  arrange(n) %&gt;% 
#  filter(n &lt; 500) %&gt;% 
#  plot_ly(x = ~start_station_longitude, y = ~start_station_latitude, type = &quot;scatter&quot;, mode = &quot;markers&quot;,
#          alpha = 0.3, 
#          color = ~n)</code></pre>
<ul>
<li>Men v. Women (1 = Male, 2 = Female)</li>
</ul>
<pre class="r"><code># Histogram of when people start their rides, by gender!
citibike_tidy %&gt;% 
  group_by(gender) %&gt;% 
  filter(gender != 0) %&gt;% 
  mutate(start_hour = str_sub(start_time, 0, 2),
         start_hour = as.numeric(start_hour)) %&gt;% 
  ggplot(aes(x = start_hour)) +
  geom_histogram() +
  labs(x = &quot;Start hour&quot;,
       y = &quot;Frequency&quot;) +
  facet_grid(~ gender)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Data_Import_files/figure-html/gender-1.png" width="672" /></p>
<ul>
<li>Age ranges and average time spent on ride</li>
</ul>
<pre class="r"><code># who are the people over 100; also, this is kind of ug the way i have done it; whose trips are more than 500 hours??????? how is this calculated??
citibike_tidy %&gt;% 
  filter(gender != 0) %&gt;% 
  mutate(trip_hour = trip_minutes / 60) %&gt;% 
  ggplot(aes(x = rider_age, y = trip_hour)) + 
  geom_point(alpha = 0.5) +
  geom_smooth(se = FALSE) +
  facet_grid(~ gender)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>## Warning: Removed 24 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 24 rows containing missing values (geom_point).</code></pre>
<p><img src="Data_Import_files/figure-html/age_length_plot-1.png" width="672" /></p>
<ul>
<li><p>Most/least popular days of the week of travel</p></li>
<li><p>Simple linear regression of trip duration vs. age, sex, time of day (categorical: morning rush hour, morning, evening rush hour), day of week</p></li>
<li><p>Map of where people start</p></li>
</ul>
<pre class="r"><code># this looks pretty dumb; is it a scale issue?
citibike_tidy %&gt;% 
  filter(start_station_longitude != 0) %&gt;% 
  ggplot(aes(x = start_station_longitude, y = start_station_latitude)) + 
  geom_point()</code></pre>
<p><img src="Data_Import_files/figure-html/map_start_plot-1.png" width="672" /></p>
<ul>
<li>Map of where people end (kind of philosophical, no?)</li>
</ul>
<pre class="r"><code>citibike_tidy %&gt;% 
  filter(end_station_longitude != 0) %&gt;% 
  ggplot(aes(x = end_station_longitude, y = end_station_latitude)) + 
  geom_point()</code></pre>
<p><img src="Data_Import_files/figure-html/map_end_plot-1.png" width="672" /></p>
<ul>
<li>Length of ride against day of month, by month</li>
</ul>
<pre class="r"><code># Histogram of how long people ride for, by month!
# can we change the month labels??

  citibike_tidy %&gt;% 
  mutate(start_day = as.numeric(start_day)) %&gt;% 
  group_by(start_month, start_day) %&gt;% 
    mutate(mean_trip_hour = mean(trip_minutes / 60)) %&gt;% 
    ggplot(aes(x = start_day, y = mean_trip_hour, color = start_month)) +
    geom_point(alpha = 0.5) +
    geom_smooth(se = FALSE) +
    labs(x = &quot;Day of the month&quot;,
         y = &quot;Mean length of trip (hours)&quot;) + 
    scale_color_hue(name = &quot;Month&quot;) +
    facet_grid(~ start_month)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="Data_Import_files/figure-html/trip_length_plot-1.png" width="672" /></p>
<p>*ongoing data questions: do we need both trip_duration and trip_minutes?</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
